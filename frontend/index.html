<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>EventSphere</title>

<style>
body{background:#acadf3;font-family:Arial;margin:0;}
.navbar{
background:#5f62f0;
color:white;
padding:18px;
font-size:30px;
text-align:center;
}

.container{width:80%;margin:auto;padding:20px;}

.card{
background:white;
padding:20px;
margin:10px 0;
border-radius:10px;
}

button{
background:green;
color:white;
border:none;
padding:8px 12px;
border-radius:5px;
cursor:pointer;
}
</style>

</head>

<body>

<script>
if(localStorage.getItem("role")!=="student"){
window.location="login.html";
}
</script>

<div class="navbar">
EventSphere Student Portal
<button onclick="logout()" style="float:right;background:red">Logout</button>
</div>

<div class="container">

<h2>Available Events</h2>
<div id="events"></div>

</div>

<script>

function logout(){
localStorage.removeItem("role");
window.location="login.html";
}

async function loadEvents(){

const res=await fetch("/api/events");
const data=await res.json();

let html="";

data.forEach(e=>{
html+=`
<div class="card">
<h3>${e.title}</h3>
<p><b>Date:</b> ${e.date}</p>
<p><b>Location:</b> ${e.location}</p>
<p>${e.description}</p>

<button onclick="registerEvent('${e.id}')">
Register
</button>

</div>`;
});

events.innerHTML=html;
}

async function registerEvent(id){

await fetch("/api/register",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
eventId:id,
user:"Student"
})
});

alert("Registered Successfully!");
}

loadEvents();

</script>

</body>
</html>